<mat-form-field appearance="outline" class="full-width">
  <mat-label>Buscar empresas</mat-label>
  <input
    type="text"
    matInput
    [formControl]="searchCtrl"
    [matAutocomplete]="auto"
    placeholder="Escribe al menos 3 letras..." />
  <mat-autocomplete #auto="matAutocomplete" (optionSelected)="addEmpresa($event.option.value)">
    <mat-option *ngFor="let empresa of resultados" [value]="empresa">
      {{ empresa }}
    </mat-option>
  </mat-autocomplete>
</mat-form-field>

<mat-chip-listbox class="full-width" multiple>
  <mat-chip-option
    *ngFor="let empresa of empresasSeleccionadas"
    [selected]="true"
    (removed)="removeEmpresa(empresa)">
    {{ empresa }}
    <button matChipRemove>
      <mat-icon>cancel</mat-icon>
    </button>
  </mat-chip-option>
</mat-chip-listbox>

<div class="dashboard-grid">
    <!-- Gráfico de líneas: Importes anuales por empresa -->
    <div class="section">
      <h3>Importe anual por empresa (2020–2025)</h3>
      <ngx-charts-line-chart
        [results]="lineChartData"
        [view]="[400, 300]"
        [legendPosition]= "legendPosition"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="true"
        [autoScale]="true"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        [xAxisLabel]="'Año'"
        [yAxisLabel]="'Importe (€)'">
      </ngx-charts-line-chart>
    </div>

    <!-- Gráfico de tarta: Importe 2025 por empresa -->
    <div class="section">
      <h3>Importe por empresa en 2025</h3>
      <ngx-charts-pie-chart
        [results]="pieChartData"
        [view]="[400, 300]"
        [legendPosition]= "legendPosition"
        [legend]="true"
        [labels]="true"
        [explodeSlices]="false"
        [doughnut]="true">
      </ngx-charts-pie-chart>
    </div>

    <!-- Gráfico de barras: Importes acumulados 2020–2025 -->
    <div class="section">
      <h3>Importe total por empresa (2020–2025)</h3>
      <ngx-charts-bar-vertical
        [results]="barChartData"
        [view]="[400, 300]"
        [legendPosition]= "legendPosition"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="false"
        [showDataLabel]="true">
      </ngx-charts-bar-vertical>
    </div>
  </div>